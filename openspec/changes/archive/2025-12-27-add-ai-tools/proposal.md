# AI 模型接入工具

## 变更 ID
`add-ai-tools`

## 目的
在主要页面添加"工具"Tab，提供统一的 AI 工具界面，包含多个 AI 生成工具（生成剧本、生成分镜脚本、图生描述、文生图、文生视频、参考图生视频、首尾帧生视频、生音频），每个工具支持异步任务处理和状态轮询，并提供历史记录管理功能。

## 为什么
当前 AI 功能分散在剧集编辑流程中，用户无法独立使用这些 AI 工具。需要一个统一的工具页面，让用户可以：
- 独立使用各种 AI 生成工具
- 查看和管理生成历史
- 复用历史记录中的输入参数

## 变更内容
1. 在主要页面添加"工具"Tab
2. 创建工具页面，包含8个AI工具
3. 实现异步任务系统（任务创建、状态管理、轮询）
4. 实现历史记录系统（生成记录、输出记录、查看详情、删除、做同款）

## 背景
当前系统中，AI 功能（如生成分镜脚本、生成图片等）都集成在剧集编辑流程中。用户需要一个独立的工具页面来使用这些 AI 能力，并能够查看和管理历史记录。

## 变更范围
- **前端**：`apps/web/index.html`、新增 `apps/web/tools.html`、`apps/web/js/tools.js`、`apps/web/styles/tools.css`
- **后端**：新增 `server/api/tools.py`、`server/api/tasks.py`
- **数据存储**：`data/tools/` 目录用于存储任务和历史记录
- **规范**：新增 `openspec/specs/ai-tools/spec.md`

## 主要改进
1. **统一工具界面**：所有 AI 工具集中在一个页面
2. **异步任务处理**：支持长时间运行的 AI 任务，前端轮询状态
3. **历史记录管理**：记录所有生成任务和输出，支持查看、删除、复用
4. **任务状态跟踪**：请求中、请求成功、失败三种状态

## 用户价值
- 提供独立的 AI 工具使用界面
- 支持异步任务，提升用户体验
- 历史记录管理，方便复用和查看
- 统一的工具入口，便于使用

## 依赖关系
- 需要集成真实的 AI API（LLM、文生图、文生视频、TTS等）
- 当前使用 mock 实现，预留真实接口调用位置

## 风险评估
- 中等风险：需要实现异步任务系统和状态轮询机制
- 需要处理任务超时、失败重试等场景
- 历史记录数据量可能较大，需要考虑存储和查询性能

